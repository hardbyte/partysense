{% extends "base.html" %}
{% load humanize %}
{% load url from future %}
{% load staticfiles %}
{% block content %}

<div class="row-fluid" ng-app="Partysense">

    <div class="span2 leftSideBar">
        <div class="">
            <h4>{{ event.title }}</h4>
            <div class="event_details">
                <dl>
                    <dt>Where:</dt>
                        <dd>{{ event.location }}</dd>
                    <dt>Host:</dt>
                        <dd><a href="/dj/{{ event.dj.pk }}/{{ event.dj.nickname|slugify }}">{{event.dj.nickname}}</a></dd>
                </dl>
            </div>
        </div>

        <div ng-controller="RecentTracksTemplateCtrl">
            <div ng-include src="template"></div>
        </div>

    </div>

    <div class="span6 offset3">
        <div ng-controller="SpotifyTemplateCtrl">
            <div ng-include src="template"></div>
        </div>

        <div id="setlist">
            <div ng-controller="SetlistTemplateCtrl">
                <div ng-include src="template"></div>
            </div>
        </div>
    </div>


    <div class="offset9">
        <div ng-controller="PreviewTemplateCtrl">
            <div ng-include src="template"></div>
        </div>
     </div>

</div>
{% endblock %}

{% block jslibs %}
    <script>
        var ps = {
            event: {{ event.pk }},
            eventTitle: "{{ event.title }}",
            LAST_FM_API_KEY: "{{ LAST_FM_API_KEY }}",
            recentTracks: [
            {% for track in recent_tracks %}
                {
                    name: "{{ track.name }}",
                    artist: "{{ track.artist }}",
                    spotify_url: "{{ track.spotify_url }}"
                },
            {% endfor %}
            ]
        };

        var lastfm = "http://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key={{ LAST_FM_API_KEY }}&format=json";
    </script>
    <script src="{% static "js/angular-1.1.4/angular.min.js" %}"></script>
    <script src="{% static "js/angular-1.1.4/angular-resource.min.js" %}"></script>
    <script src="{% static "js/filters.js" %}"></script>
    <script src="{% static "js/services.js" %}"></script>
    <script src="{% static "js/partysense.js" %}"></script>

{% endblock %}