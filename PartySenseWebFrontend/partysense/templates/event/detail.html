{% extends "event/event_base_template.html" %}
{% load humanize %}
{% load url from future %}
{% load staticfiles %}
{% load compress %}

{% block event_content %}
    <div class="col-md-6">

        {% if event.dj.user == user %}
            <a class="btn btn-block btn-primary"
               href="{% url "event:stats" event.pk event.slug %}">
                <i class="icon-signal"></i> Event Analytics
            </a>
        {% endif %}

        <section>

            {% if not user.is_authenticated %}
                <a class="btn btn-primary btn-block btn-large" href="{% url "password_login" %}{% if request.GET.next %}?next={{ request.GET.next }}{% endif %}">
                    Login to vote on the music!
                </a>
            {% endif %}

          {% if event.user_editable or event.dj.user == user %}
            <div>
                <div ng-include src="resultListTemplate"></div>
            </div>
          {% endif %}

            <div id="setlist">
                <div>
                    <div ng-include src="setlistTemplate"></div>
                </div>
            </div>
        </section>
    </div>

    <div class="col-md-3 hidden-xs hidden-sm">
        <div>
            <div ng-include src="previewTemplate"></div>
        </div>

        <div id="GoogleAdvert">
            {% if not debug %}
            <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- Party Sense - Med Rect -->
            <ins class="adsbygoogle"
                 style="display:inline-block;width:300px;height:250px"
                 data-ad-client="ca-pub-6160731913142438"
                 data-ad-slot="5621308889"></ins>
            <script>

            (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
            {% endif %}
        </div>

     </div>
{% endblock %}

{% block event_js %}

  {% if event.location.latitude and event.location.longitude %}
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjOEItJV2ny3PQzAB6jeoQztOHvqBnQ_I&sensor=false"></script>
    {% compress js %}
      <script type="text/javascript">
      function initialize() {
        var loc = new google.maps.LatLng({{ event.location.latitude }}, {{ event.location.longitude }});

        var mapOptions = {
            center: loc,
            zoom: 16,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            disableDefaultUI: true, // disable the overlay because we don't have room
            draggable: true
        };
        google.maps.visualRefresh = true;
        var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
        var my_point = new google.maps.Marker({
            position: loc,
            map: map,
            draggable: false
        });
      }
      google.maps.event.addDomListener(window, 'load', initialize);
      </script>
    {% endcompress %}
  {% endif %}
{% endblock %}